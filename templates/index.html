<!DOCTYPE html>
<html>
<head>
	<title>Jeopardy</title>
	<script src="http://code.jquery.com/jquery-1.7.2.min.js"></script>
    <!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
     <link href="http://getbootstrap.com/examples/jumbotron-narrow/jumbotron-narrow.css" rel="stylesheet">
     <style>
     	body {
     		margin:20%;
     		margin-top:5%;
     	}
     .jumbotron {
     	text-align: center;
     }
     .takki {
     	padding:10%;
     	margin:2%;
     }
     </style>

</head>
<body>
	 <div class="jumbotron">
        <h1>Verkefni 5</h1>
         <div id='answerBox'></div>
         <select id="categorySelect" class="form-control"></select>

        <button id="categoryBtn" class="btn btn-lg btn-primary btn-block" type="button">Get Categories</button>
      </form>
      </div>

	<script>
		$(function() {
			$('#categorySelect').hide()
			//Random question
			$('#categoryBtn').click(function() {
		        $.ajax({
		            url: '/getCategories',
		            data: $('form').serialize(),
		            dataType: 'json',
		            type: 'GET',
		            success: function(response) {
		            	$('#answerBox').html('');
						

		            	for(i = 0; i < response.length; i++) {
		            		$('#categorySelect').append('<option value="'+ response[i]['id'] + '">'+ response[i]['title'] + '</option>')

		            	$('#categorySelect').show()
							/*
		            		$('#answerBox').append('<button onclick="category(' + response[i]['id'] + ')" " class="btn btn-lg btn-primary btn-block" type="button">' + response[i]['title'] + '</button>')
		            		*/
		            	}
		                console.log(response);
		            },
		            error: function(error) {
		                console.log(error);
		            }	
        		});
			});


		$('#categorySelect').change(function() {
			var id = $(this).val();
			category(id);
		});

		$(document).on('click', '.takki', function(){
			var id = $(this).attr('id')
			var answer = $('#answer' + id).val()
			console.log(answer)
			console.log(id)
			$.ajax({
				url: '/submitAnswer',
				data: {'data': answer},
				datatype: 'json',
				type: 'GET',
				success: function(response) {
					console.log(response)
				}
			})
		});
	});
	

	
	function getValue(valID) {
		$('#questionBox' + valID).show()
		$('#questionBox'+ valID).append('<button id="' + valID + '" class="takki btn btn-primary">Submit!</button>')
	}
	function category(catID) {
		var category = $('#categorySelect option:selected').text()
		$('#categorySelect').hide()
		$('#categoryBtn').hide()
		$.ajax({
			url:'/getCategory',
			data : {'data':catID}, 
			dataType: 'json',
				type: 'GET',	
			success: function(response) {
				console.log(response['clues'])
				$('#answerBox').html('');
				$('#answerBox').append('<p>' + category + '</p>')
				for (i = 0; i < response['clues'].length;i++) {
					$('#answerBox').append('<button onClick="getValue(' + response['clues'][i]['id'] + ')" id="' + response['clues'][i]['id'] + '" class="btn btn-primary">$' + response['clues'][i]['value'] + '</button>')
					}
				for (i = 0; i < response['clues'].length;i++) {
					$('#answerBox').append('<div id="questionBox' + response['clues'][i]['id'] + '"></div>')
					$('#questionBox' + response['clues'][i]['id']).append('<p id="q' +response['clues'][i]['id'] + '">' + response['clues'][i]['question'] + '</p>')
					$('#questionBox' + response['clues'][i]['id']).append('<input type="text" id="answer' + response['clues'][i]['id'] + '" class="form-control">')
					$('#questionBox' + response['clues'][i]['id']).hide()
				}
				},
			error: function(error) {
			}
		});
	};	

	</script>
</body>
</html>


